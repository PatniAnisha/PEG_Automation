package com.zycus.eInvoice.PO;

import java.util.Date;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

import com.relevantcodes.extentreports.ExtentTest;

import Common.eInvoice_CommonFunctions;

/**
 * <p>
 * <b> Title: </b> InvoiceAgainstPO.java</br>
 * <br>
 * <b> Description: </b> create new Invoice against PO</br>
 * <br>
 * <b> Functions: </br>
 * </b> <br>
 * 1.createNewInvoice: user is able to create an Invoice against a PO </br>
 * <br>
 * @author Anisha
 * @since May 2018
 */

public class CreditMemoagainstPO extends eInvoice_CommonFunctions {
	private ExtentTest logger;
	private WebDriver driver;
	private String creditMemoNo;
	private Date creditMemoDate;

	public CreditMemoagainstPO(WebDriver driver, ExtentTest logger) {
		super(driver, logger);
		this.driver = driver;
		this.logger = logger;
	}

	public CreditMemoagainstPO(WebDriver driver, ExtentTest logger, String creditMemoNo, Date creditMemoDate) {
		super(driver, logger);
		this.driver = driver;
		this.logger = logger;
		this.creditMemoNo = creditMemoNo;
		this.creditMemoDate = creditMemoDate;
		// TODO Auto-generated constructor stub
	}
	/**
	 * <b>Function:</b> createCreditMemo
	 * 
	 * @author Anisha
	 * @param none 
	 * @since May 2018
	 * @throws Exception
	 * @return status
	 */
	public boolean createCreditMemo() {
		boolean status = false;
		try {
			sendKeys(By.id("txtInvoiceNumber"), creditMemoNo);
			selectDate(creditMemoDate);
			addAttachment();
			if (findElement(By.id("vng-collapsibleGrid")).isDisplayed())
				click(By.xpath("//*[@id='vng-collapsibleGrid']//tr[1]/td[1]/input"));
			click(By.id("btnSubmit"));
			waitUntilInvisibilityOfElement(By.xpath("//*[@id='status_overlay_updateInvoice']"));
			if(findElement(By.xpath("//*[@id='invoiceGrid']/tbody/tr[*]/td[1]/a[text()='"+creditMemoNo+"']")).isDisplayed())
				status = true;
		} catch (Exception e) {

		}
		return status;

	}

}
