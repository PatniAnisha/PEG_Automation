package com.zycus.eProc.Approval;

import java.text.ParseException;
import java.util.Date;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;

//import com.zycus.eInvoice.Invoice.PurchaseOrder;
//import com.zycus.eInvoice.Invoice.RequisitionInfo;

import Common.eProc_CommonFunctions;

import com.relevantcodes.extentreports.ExtentTest;

/**
 * <p>
 * <b> Title: </b> ApprovalDetails.java</br>
 * <br>
 * <b> Description: </b> To perform operations on pages Approval & All Requests
 * </br>
 * <br>
 * <b> Functions: </br>
 * </b> <br>
 * 1.filterByStatus: user shall be able to filter by Status </br>
 * <br>
 * 2.filterByReceivedOn: user shall be able to filter by Received On </br>
 * 
 * @author Varun Khurana
 * @since April 2018
 */

public class ApprovalDetails extends eProc_CommonFunctions {

	private WebDriver driver;
	private ExtentTest logger;

	// private By processingLoader = By.id("workflowApproval_processing");
	private By processingLoader = By.xpath("//div[contains(@id,'processing')]");
	private By statusXpath = By.xpath("//table[@id='workflowApproval']//td[2]/div");
	private By dateXpath = By.xpath("//table[@id='workflowApproval']//td[contains(@class,'receivedOn')]");
	private By statusTxtXpath = By.xpath("(//table[@id='workflowApproval']//td[2]/div)[1]");
	private By actionsLinkXpath = By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]");
	private By requisitionNumTxtXpath = By.xpath("(//table[@id='workflowApproval']//td[3]/a)[1]");
	private By requisitionNameTxtXpath = By.xpath("(//table[@id='workflowApproval']//td[4])[1]");

	/**
	 * Constructor for the class
	 * 
	 * @param driver
	 */

	public ApprovalDetails(WebDriver driver, ExtentTest logger) { 
		super(driver, logger);
		this.driver = driver;
		this.logger = logger;
	}

	/**
	 * <b>Function:</b> filterByStatus - To filter by Status
	 * 
	 * @author Varun Khurana
	 * @since April 2018
	 * @param checkBoxLbl
	 *            - Label of the checkbox which is to be selected
	 * @return result - True/False
	 */

	public boolean filterByStatus(String checkBoxLbl) {
		boolean result = false;
		try {
			String colName = "Status";
			// click(By.xpath("//th[contains(@class,'statusFilter')]//b"));
			int colNo = getColNum(colName);
			click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
			filterByChkbox(checkBoxLbl);
			result = verifyFilteredStatus(colName, colNo, checkBoxLbl) ? true : false;
		} catch (Exception e) {
			e.printStackTrace();
		}
		return result;
	}

	/**
	 * <b>Function:</b> filterByReceivedOn - To filter by Received On
	 * 
	 * @author Varun Khurana
	 * @since April 2018
	 * @param fromDt
	 *            - From Date , ToDt - To Date
	 * @throws ParseException
	 * @return result - True/False
	 */

	public boolean filterByReceivedOn(Date fromDt, Date ToDt) throws ParseException {
		boolean result = false;
		try {
			String colName = "Received On";
			// click(By.xpath("//th[contains(@class,'receivedOnFilter')]//b"));
			int colNo = getColNum(colName);
			click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
			filterByDateRange(fromDt, ToDt);
			result = verifyFilteredDates(colNo, fromDt, ToDt) ? true : false;
		} catch (Exception e) {
			e.printStackTrace();
		}
		return result;
	}

	/**
	 * <p>
	 * <b> Title: </b> Requisition.java</br>
	 * <br>
	 * <b> Description: </b> To perform operations on pages Approval - Approval
	 * Requests - Requisition </br>
	 * <br>
	 * <b> Functions: </br>
	 * </b> <br>
	 * 1.filterByStatus: user shall be able to filter by Status </br>
	 * <br>
	 * 2.filterByReceivedOn: user shall be able to filter by Received On </br>
	 * 
	 * @author Varun Khurana
	 * @since April 2018
	 */

	private class Requisition extends ApprovalDetails {
		private WebDriver driver;

		private By amountXpath = By.xpath("//table[@id='workflowApproval']//td[contains(@class,'entityAmount')]");

		private ExtentTest logger;
	public Requisition(WebDriver driver, ExtentTest logger) { 
			super(driver, logger);
			this.driver = driver;
			this.logger = logger;
		}

		/**
		 * <b>Function:</b> filterByAmountToApprove - To filter by 'Amount to be
		 * approved'
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param fromAmt
		 *            - From Amount , ToAmt - To Amount
		 * @return result - True/False
		 */

		public boolean filterByAmountToApprove(float fromAmt, float ToAmt) {
			boolean result = false;
			try {
				String colName = "Amount to be approved";
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'amountFilter')]//b"));
				filterByAmtRange(fromAmt, ToAmt);
				result = verifyFilteredAmount(colNo, fromAmt, ToAmt) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * <b>Function:</b> filterByAmountToApprove - To filter by 'Amount to be
		 * approved'
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param fromAmt
		 *            - From Amount , ToAmt - To Amount, currType - Type of
		 *            currency
		 * @return result - True/False
		 */

		public boolean filterByAmountToApprove(float fromAmt, float ToAmt, String currType) {
			boolean result = false;
			String colName = "Amount to be approved";
			try {
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'amountFilter')]//b"));
				filterByAmtRange(fromAmt, ToAmt, currType);
				result = verifyFilteredAmount(colNo, fromAmt, ToAmt, currType) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * <b>Function:</b> verifyDisplayedAction - To verify if the action
		 * displayed under 'Actions' list is correct as per the Status
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param action
		 *            - Action from the 'Actions' list
		 * @return result - True/False
		 */

		protected boolean verifyDisplayedAction(String action) {
			boolean result = false;

			String status = findElement(statusTxtXpath).getText();

			switch (action) {
			case "View":
				if (status.equals("Pending") || status.equals("Approved") || status.equals("Rejected"))
					result = true;
				break;
			case "Approve":
			case "Reject":
			case "Delegate":
			case "Ask more info":
				if (status.equals("Pending"))
					result = true;
				break;
			}
			return result;

		}

		/**
		 * <b>Function:</b> selectAction - To verify if the action displayed
		 * under 'Actions' list is correct as per the Status
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param action
		 *            - Action from the 'Actions' list
		 * @return result - True/False
		 * @throws Exception 
		 */

		public boolean selectAction(String action) throws Exception {
			boolean result = false;

			click(actionsLinkXpath);
			click(By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]/following-sibling::ul//a[text()='"
					+ action + "']"));

			if (verifyDisplayedAction(action)) {

				WebElement objRequisitionNum = findElement(requisitionNumTxtXpath);
				String requisitionNum = objRequisitionNum.getText();

				WebElement objRequisitionName = findElement(requisitionNameTxtXpath);
				String requisitionName = objRequisitionName.getText();

				switch (action) {
				case "View":
					RequisitionInfo objReqInfo = new RequisitionInfo(driver, logger);
					if (findElement(objReqInfo.getHeaderReqNum()).getText() == requisitionNum
							&& findElement(objReqInfo.getHeaderReqName()).getText() == requisitionName)
						result = true;
					else {
						System.out.println("Requested Requisition not opened for Create Receipt");
						result = false;
					}
					break;
				}
			} else
				System.out.println("Requisition is not in required status for the requested action");
			return result;

		}

		/**
		 * <b>Function:</b> selectAction - To verify if the action displayed
		 * under 'Actions' list is correct as per the Status
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param action
		 *            - Action from the 'Actions' list, actionComments -
		 *            Comments when action is Approve/Reject
		 * @return result - True/False
		 * @throws Exception 
		 */

		public boolean selectAction(String action, String actionComments) throws Exception {
			boolean result = false;

			click(actionsLinkXpath);
			click(By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]/following-sibling::ul//a[text()='"
					+ action + "']"));

			if (verifyDisplayedAction(action)) {

				switch (action) {
				case "Approve":
					sendKeys(By.id("approvalComments"), actionComments);
					click(By.id("approveCommentBtn"));
				case "Reject":
					sendKeys(By.id("rejectComments"), actionComments);
					click(By.id("rejectCommentBtn"));
				}
			} else
				System.out.println("Requisition is not in required status for the requested action");
			return result;

		}

		/**
		 * <b>Function:</b> selectAction - To verify if the action displayed
		 * under 'Actions' list is correct as per the Status
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param action
		 *            - Action from the 'Actions' list, actionToUser - 'To'
		 *            field for Delegate/Ask more info actions, actionComments -
		 *            Comments
		 * @return result - True/False
		 * @throws Exception 
		 */

		public boolean selectAction(String action, String actionToUser, String actionComments) throws Exception {
			boolean result = false;

			click(actionsLinkXpath);
			click(By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]/following-sibling::ul//a[text()='"
					+ action + "']"));

			if (verifyDisplayedAction(action)) {

				switch (action) {
				case "Delegate":
					findElement(By.id("txtDelegateName")).sendKeys(actionToUser);
					if (findElement(By.xpath("//div[@id='dev_delegateDialog']/following-sibling::ul[1]")) != null)
						click(By.xpath("//div[@id='dev_delegateDialog']/following-sibling::ul[1]/li[1]/a"));
					else
						System.out.println("'Delegate Approval To' list to select names not displayed");
					sendKeys(By.id("delegateComments"), actionComments);
					click(By.id("btnDelegateSave"));
				case "Ask more info":
					sendKeys(
							By.xpath(
									"//*[contains(@id,'viewNewDiscussionDOMComponent')]//li[contains(@class,'convMsg')]//textarea"),
							actionComments);
					click(By.id("postCommentBtn"));
					break;
				}
			} else
				System.out.println("Requisition is not in required status for the requested action");
			return result;

		}

		/**
		 * <b>Function:</b> selectAction - To verify if the action displayed
		 * under 'Actions' list is correct as per the Status
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param action
		 *            - Action from the 'Actions' list
		 * @return result - True/False
		 * @throws Exception 
		 */

		public boolean selectAction(String action, String msgTo, String msgCc, String actionComments, String sharedWith,
				String filePath) throws Exception {
			boolean result = false;

			click(actionsLinkXpath);
			click(By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]/following-sibling::ul//a[text()='"
					+ action + "']"));

			if (verifyDisplayedAction(action)) {

				switch (action) {
				case "Ask more info":
					if (findElement(By.xpath("//div[@id='newDiscussionForm']/following-sibling::ul[1]")) != null)
						click(By.xpath("//div[@id='newDiscussionForm']/following-sibling::ul[1]/li[1]/a"));
					else
						System.out.println("'To' list to select names not displayed");
					if (findElement(By.xpath("//div[@id='newDiscussionForm']/following-sibling::ul[2]")) != null)
						click(By.xpath("//div[@id='newDiscussionForm']/following-sibling::ul[2]/li[1]/a"));
					else
						System.out.println("'CC' list to select names not displayed");
					sendKeys(
							By.xpath(
									"//*[contains(@id,'viewNewDiscussionDOMComponent')]//li[contains(@class,'convMsg')]//textarea"),
							actionComments);
					WebElement sharedWithChkbox = findElement(By.xpath(
							"//*[contains(@id,'viewNewDiscussionDOMComponent')]//li[contains(@class,'discAreaTree')]/div/label[text()[contains(.,'All')]]/input"));
					if (!sharedWithChkbox.isSelected())
						sharedWithChkbox.click();
					uploadFile(filePath);
					click(By.id("postCommentBtn"));
					break;
				}
			} else
				System.out.println("Requisition is not in required status for the requested action");
			return result;

		}

	}

	private class Standard_PO extends ApprovalDetails {
		private WebDriver driver;

		private By amountXpath = By.xpath("//table[@id='workflowApproval']//td[contains(@class,'entityAmount')]");

		private ExtentTest logger;
	public Standard_PO(WebDriver driver, ExtentTest logger) throws Exception { 
			super(driver, logger);
			this.driver = driver;
			this.logger = logger;
			click(By.xpath("//div[contains(@class,'productSelectionTab')]/ul/li/a[text()='Standard PO']"));
		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : filterByType
		 * 
		 * @param typeValue
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 */

		public boolean filterByType(String checkBoxLbl) {
			boolean result = false;
			try {
				String colName = "Type";
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'documentTypeFilter')]//b"));
				filterByChkbox(checkBoxLbl);
				result = verifyFilteredStatus(colName, colNo, checkBoxLbl) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * <b>Function:</b> filterByAmountToApprove - To filter by 'Amount to be
		 * approved'
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param fromAmt
		 *            - From Amount , ToAmt - To Amount
		 * @return result - True/False
		 */

		public boolean filterByAmountToApprove(float fromAmt, float ToAmt) {
			boolean result = false;
			try {
				String colName = "Amount to be approved";
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'amountFilter')]//b"));
				filterByAmtRange(fromAmt, ToAmt);
				result = verifyFilteredAmount(colNo, fromAmt, ToAmt) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * <b>Function:</b> filterByAmountToApprove - To filter by 'Amount to be
		 * approved'
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param fromAmt
		 *            - From Amount , ToAmt - To Amount, currType - Type of
		 *            currency
		 * @return result - True/False
		 */

		public boolean filterByAmountToApprove(float fromAmt, float ToAmt, String currType) {
			boolean result = false;
			String colName = "Amount to be approved";
			try {
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'amountFilter')]//b"));
				filterByAmtRange(fromAmt, ToAmt, currType);
				result = verifyFilteredAmount(colNo, fromAmt, ToAmt, currType) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : verifyDisplayedAction
		 * 
		 * @param action
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 */

		protected boolean verifyDisplayedAction(String action) {
			boolean result = false;

			String status = findElement(statusTxtXpath).getText();
			switch (action) {
			case "View":
				if (status.equals("Approved") || status.equals("Rejected"))
					result = true;
				break;
			}
			return result;

		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : takeAction
		 * 
		 * @param action
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 * @throws Exception 
		 */

		public boolean takeAction(String action) throws Exception {
			boolean result = false;

			click(actionsLinkXpath);
			click(By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]/following-sibling::ul//a[text()='"
					+ action + "']"));

			if (verifyDisplayedAction(action)) {

				WebElement objRequisitionNum = findElement(requisitionNumTxtXpath);
				String requisitionNum = objRequisitionNum.getText();

				WebElement objRequisitionName = findElement(requisitionNameTxtXpath);
				String requisitionName = objRequisitionName.getText();

				switch (action) {
				case "View":
					PurchaseOrder objPurchaseOrder = new PurchaseOrder(driver, logger);
					if (findElement(objPurchaseOrder.getHeaderReqNum()).getText() == requisitionNum
							&& findElement(objPurchaseOrder.getHeaderReqName()).getText() == requisitionName)
						result = true;
					else {
						System.out.println("Requested Requisition not opened for Create Receipt");
						result = false;
					}
					break;
				}
			} else
				System.out.println("Requisition is not in required status for the requested action");
			return result;

		}

	}

	private class Blanket_PO extends ApprovalDetails {
		private WebDriver driver;

		private By amountXpath = By.xpath("//table[@id='workflowApproval']//td[contains(@class,'entityAmount')]");

		private ExtentTest logger;
	public Blanket_PO(WebDriver driver, ExtentTest logger) throws Exception { 
			super(driver, logger);
			this.driver = driver;
			this.logger = logger;
			click(By.xpath("//div[contains(@class,'productSelectionTab')]/ul/li/a[text()='Blanket PO']"));
		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : filterByStatus
		 * 
		 * @param typeValue
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 */

		public boolean filterByType(String checkBoxLbl) {
			boolean result = false;
			try {
				String colName = "Type";
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'documentTypeFilter')]//b"));
				filterByChkbox(checkBoxLbl);
				result = verifyFilteredStatus(colName, colNo, checkBoxLbl) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * <b>Function:</b> filterByAmountToApprove - To filter by 'Amount to be
		 * approved'
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param fromAmt
		 *            - From Amount , ToAmt - To Amount
		 * @return result - True/False
		 */

		public boolean filterByAmountToApprove(float fromAmt, float ToAmt) {
			boolean result = false;
			try {
				String colName = "Amount to be approved";
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'amountFilter')]//b"));
				filterByAmtRange(fromAmt, ToAmt);
				result = verifyFilteredAmount(colNo, fromAmt, ToAmt) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * <b>Function:</b> filterByAmountToApprove - To filter by 'Amount to be
		 * approved'
		 * 
		 * @author Varun Khurana
		 * @since April 2018
		 * @param fromAmt
		 *            - From Amount , ToAmt - To Amount, currType - Type of
		 *            currency
		 * @return result - True/False
		 */

		public boolean filterByAmountToApprove(float fromAmt, float ToAmt, String currType) {
			boolean result = false;
			String colName = "Amount to be approved";
			try {
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'amountFilter')]//b"));
				filterByAmtRange(fromAmt, ToAmt, currType);
				result = verifyFilteredAmount(colNo, fromAmt, ToAmt, currType) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : verifyDisplayedAction
		 * 
		 * @param action
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 */

		protected boolean verifyDisplayedAction(String action) {
			boolean result = false;

			String status = findElement(statusTxtXpath).getText();
			switch (action) {
			case "View":
				if (status.equals("Approved") || status.equals("Rejected"))
					result = true;
				break;
			}
			return result;

		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : takeAction
		 * 
		 * @param action
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 * @throws Exception 
		 */

		public boolean takeAction(String action) throws Exception {
			boolean result = false;

			click(actionsLinkXpath);
			click(By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]/following-sibling::ul//a[text()='"
					+ action + "']"));

			if (verifyDisplayedAction(action)) {

				WebElement objRequisitionNum = findElement(requisitionNumTxtXpath);
				String requisitionNum = objRequisitionNum.getText();

				WebElement objRequisitionName = findElement(requisitionNameTxtXpath);
				String requisitionName = objRequisitionName.getText();

				switch (action) {
				case "View":
					PurchaseOrder objPurchaseOrder = new PurchaseOrder(driver, logger);
					if (findElement(objPurchaseOrder.getHeaderReqNum()).getText() == requisitionNum
							&& findElement(objPurchaseOrder.getHeaderReqName()).getText() == requisitionName)
						result = true;
					else {
						System.out.println("Requested Requisition not opened for Create Receipt");
						result = false;
					}
					break;
				}
			} else
				System.out.println("Requisition is not in required status for the requested action");
			return result;

		}

	}

	private class Catalog extends ApprovalDetails {
		private WebDriver driver;

		private By supplierXpath = By.xpath("//table[@id='workflowApproval']//td[5]");
		private By catalogNameTxtXpath = By.xpath("(//table[@id='workflowApproval']//td[3]/a)[1]");
		private By receivedOnTxtXpath = By.xpath("(//table[@id='workflowApproval']//td[4])[1]");

		private ExtentTest logger;
	public Catalog(WebDriver driver, ExtentTest logger) throws Exception { 
			super(driver, logger);
			this.driver = driver;
			this.logger = logger;
			click(By.xpath("//div[contains(@class,'productSelectionTab')]/ul/li/a[text()='Catalog']"));
		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : filterByStatus
		 * 
		 * @param typeValue
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 */
		public boolean filterByType(String checkBoxLbl) {
			boolean result = false;
			try {
				String colName = "Type";
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'documentTypeFilter')]//b"));
				filterByChkbox(checkBoxLbl);
				result = verifyFilteredStatus(colName, colNo, checkBoxLbl) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			return result;
		}

		public boolean filterBySupplier(String checkBoxLbl) {
			boolean result = false;
			try {
				String colName = "Supplier";
				int colNo = getColNum(colName);
				click(By.xpath("//tr[2]/th[" + colNo + "]//b"));
				// click(By.xpath("//th[contains(@class,'documentTypeFilter')]//b"));
				filterByChkbox(checkBoxLbl);
				result = verifyFilteredStatus(colName, colNo, checkBoxLbl) ? true : false;
			} catch (Exception e) {
				e.printStackTrace();
			}
			// click(By.xpath("//th[contains(@class,'supplierFilter')]//b"));
			return result;
		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : verifyDisplayedAction
		 * 
		 * @param action
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 */

		protected boolean verifyDisplayedAction(String action) {
			boolean result = false;

			String status = findElement(statusTxtXpath).getText();
			switch (action) {
			case "View":
				if (status.equals("Approved") || status.equals("Rejected"))
					result = true;
				break;
			}
			return result;

		}

		/**
		 * ---------------------------------------------------------------------------------
		 * Function : takeAction
		 * 
		 * @param action
		 * @return result
		 *         ---------------------------------------------------------------------------------
		 * @throws Exception 
		 */

		public boolean takeAction(String action) throws Exception {
			boolean result = false;

			click(actionsLinkXpath);
			click(By.xpath("(//*[@id='workflowApproval']//a[@class='icon actLnk'])[1]/following-sibling::ul//a[text()='"
					+ action + "']"));

			if (verifyDisplayedAction(action)) {

				WebElement objCatalogName = findElement(catalogNameTxtXpath);
				String catalogName = objCatalogName.getText();

				WebElement objReceivedOn = findElement(receivedOnTxtXpath);
				String receivedOn = objReceivedOn.getText();

				switch (action) {
				case "View":
					PurchaseOrder objPurchaseOrder = new PurchaseOrder(driver, logger);
					if (findElement(objPurchaseOrder.getHeaderReqNum()).getText() == catalogName
							&& findElement(objPurchaseOrder.getHeaderReqName()).getText() == receivedOn)
						result = true;
					else {
						System.out.println("Requested Requisition not opened for Create Receipt");
						result = false;
					}
					break;
				}
			} else
				System.out.println("Requisition is not in required status for the requested action");
			return result;

		}

	}

}
