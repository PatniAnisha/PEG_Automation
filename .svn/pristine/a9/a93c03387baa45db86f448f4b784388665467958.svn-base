package com.zycus.eInvoice.Invoice;

import java.util.Date;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;

import com.relevantcodes.extentreports.ExtentTest;

import Common.eInvoice_CommonFunctions;

//modified by Anisha
/**
 * <p>
 * <b> Title: </b> CreditMemowithoutReference.java</br>
 * <br>
 * <b> Description: </b> create Credit Memo without Reference</br>
 * <br>
 * <b> Functions: </br>
 * </b> <br>
 * 1.createCreditMemo: user is able to create a Credit Memo without
 * reference </br>
 * <br>
 * 
 * @author Anisha
 * @since May 2018
 */
public class CreditMemowithoutReference extends eInvoice_CommonFunctions {

	private ExtentTest logger;
	private WebDriver driver;
	private String supplierName;
	private String currency_value;
	private String creditMemoNo;
	private Date creditMemoDate;
	private String purchaseType;
	private String item_no;
	private String description;
	private String product_cat;
	private String market_prc;
	private String quantity;

	public CreditMemowithoutReference(WebDriver driver, ExtentTest logger) {
		super(driver, logger);
		this.logger = logger;
		this.driver = driver;
	}

	public CreditMemowithoutReference(WebDriver driver, ExtentTest logger, String supplierName, String currency_value,
			String creditMemoNo, Date creditMemoDate, String purchaseType, String item_no, String description,
			String product_cat, String market_prc, String quantity) {
		super(driver, logger);
		this.logger = logger;
		this.driver = driver;
		this.supplierName = supplierName;
		this.currency_value = currency_value;
		this.creditMemoNo = creditMemoNo;
		this.creditMemoDate = creditMemoDate;
		this.purchaseType = purchaseType;
		this.item_no = item_no;
		this.description = description;
		this.product_cat = product_cat;
		this.market_prc = market_prc;
		this.quantity = quantity;
	}

	/**
	 * <b>Function:</b> createCreditMemo
	 * 
	 * @author Anisha
	 * @since May 2018
	 * @param none
	 * @throws Exception
	 * @return status
	 */
	public boolean createCreditMemo() {
		boolean status = false;
		try {
			selectSupplier(supplierName);
			selectCurrency(currency_value);
			selectAddress();
			/*
			 * credit memo details
			 */
			sendKeys(By.id("txtInvoiceNumber"), creditMemoNo);
			selectDate(creditMemoDate);
			click(By.xpath("//*[@id='slctPurchaseType']/option[contains(text(),'" + purchaseType + "')]"));
			click(By.xpath(".//*[@id='addMoreItems']//span[contains(text(),'Add Item')]"));
			add_item(item_no, description, product_cat, market_prc, quantity);
			click(By.id("btnSubmit"));
		} catch (Exception e) {

		}
		return status;
	}

}
